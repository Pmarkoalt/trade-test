# Bucket B: Top-Cap Crypto Strategy Configuration
# Aggressive crypto strategy for top market cap coins
# Focus: higher turnover, volatility-aware sizing, adaptive exits

name: "bucket_b_topcat_crypto"
asset_class: "crypto"
universe: "dynamic_top_10"  # Dynamic top 10 by volume/market cap
benchmark: "BTC"

# Dynamic universe configuration (top N by volume)
universe_config:
  mode: "dynamic"  # Dynamic selection based on volume
  min_volume_usd: 5000000  # Minimum $5M daily dollar volume
  min_liquidity_score: 0.3  # Minimum liquidity score (0-1)
  max_symbols: 10  # Top 10 coins
  rebalance_frequency: "monthly"  # Rebalance universe monthly
  rebalance_lookback_days: 30  # 30-day lookback for metrics

# Indicator calculation parameters
indicators:
  ma_periods: [20, 50, 200]
  atr_period: 14
  roc_period: 60
  breakout_fast: 20
  breakout_slow: 55
  adv_lookback: 20
  corr_lookback: 20

# Eligibility filter (strict trend, optional volatility filter)
eligibility:
  trend_ma: 200  # Not used for crypto (use require_close_above_ma200 instead)
  ma_slope_lookback: 20  # Not used for crypto
  ma_slope_min: 0.005  # Not used for crypto
  require_close_above_trend_ma: false  # Not used for crypto
  require_close_above_ma200: true  # STRICT: Must be above MA200
  relative_strength_enabled: false  # MVP: off, can enable to filter vs BTC
  relative_strength_min: 0.0  # Must outperform BTC if enabled
  
  # Volatility filter (custom for Top-Cap Crypto)
  volatility_filter_enabled: false  # Set to true to filter high volatility
  max_volatility_ratio: 0.15  # Maximum ATR14/close ratio (15%)

# Entry trigger configuration
entry:
  fast_clearance: 0.005  # 0.5% above prior 20D high
  slow_clearance: 0.010  # 1.0% above prior 55D high

# Exit configuration (staged for crypto)
exit:
  mode: "staged"  # Staged exit for crypto
  exit_ma: 50  # MA50 triggers final exit
  hard_stop_atr_mult: 3.5  # Initial stop = entry - 3.5 * ATR14 (wider for volatility)
  tightened_stop_atr_mult: 2.0  # After MA20 break: tighten to 2.0 * ATR14

# Risk management (aggressive but controlled)
risk:
  risk_per_trade: 0.0075  # 0.75% of equity per trade (standard)
  max_positions: 8  # Maximum 8 positions
  max_exposure: 0.80  # 80% maximum gross exposure
  max_position_notional: 0.15  # 15% maximum per position

# Capacity constraints (stricter than equity)
capacity:
  max_order_pct_adv: 0.0025  # 0.25% of 20D average dollar volume (strict)

# Execution costs (higher for crypto)
costs:
  fee_bps: 10  # 10 basis points per side (higher than standard 8)
  slippage_base_bps: 12  # Base slippage (12 bps for crypto, higher volatility)
  slippage_std_mult: 0.75  # Standard deviation multiplier
  weekend_penalty: 1.5  # 1.5x slippage on weekends (24/7 trading)
  stress_threshold: -0.05  # BTC weekly return < -5% triggers stress
  stress_slippage_mult: 2.0  # Double slippage during stress

# ML model integration (optional)
ml:
  enabled: false  # Set to true to enable ML signal enhancement
  model_path: null  # Path to saved ML model directory (required if enabled)
  prediction_mode: "score_enhancement"  # Options: "score_enhancement", "filter", "replace"
  ml_weight: 0.3  # Weight for ML prediction in score_enhancement mode (0.0-1.0)
  confidence_threshold: 0.5  # Minimum confidence for filtering mode (0.0-1.0)
